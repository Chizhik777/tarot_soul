<!DOCTYPE html>
<html lang="ru" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞—Ä–æ —Å –î—É—à–æ–π | –ï–ª–µ–Ω–∞</title>
    <!-- FAVICON (–õ—É–Ω–∞) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåô</text></svg>">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        void: '#020202', 
                        gold: {
                            100: '#F9F1D8',
                            300: '#E6C87C',
                            500: '#D4AF37', 
                            700: '#997B1E',
                            900: '#423206',
                        },
                    },
                    fontFamily: {
                        heading: ['Cinzel Decorative', 'serif'],
                        body: ['Cormorant Garamond', 'serif'],
                    },
                    backgroundImage: {
                        'gold-gradient': 'linear-gradient(135deg, #D4AF37 0%, #F9F1D8 50%, #997B1E 100%)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #000000;
            color: #E6C87C;
            overflow-x: hidden;
            cursor: none; 
            position: relative;
        }

        @media (hover: none) and (pointer: coarse) {
            body { cursor: auto !important; }
            #custom-cursor { display: none !important; }
            .btn-gold, .portal-container, .glass-panel, .cursor-pointer, input, textarea, button { cursor: pointer !important; }
        }

        /* --- CUSTOM CURSOR --- */
        #custom-cursor {
            position: fixed;
            width: 20px; height: 20px;
            background: radial-gradient(circle, #fff 0%, #D4AF37 50%, transparent 80%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px 5px rgba(212, 175, 55, 0.6);
            mix-blend-mode: screen;
            transition: width 0.2s, height 0.2s;
        }
        #custom-cursor.active { width: 40px; height: 40px; }

        /* --- PRELOADER --- */
        #preloader { transition: opacity 0.8s ease-out, visibility 0.8s; }
        #preloader.loaded { opacity: 0; visibility: hidden; }

        /* --- BACKGROUND LAYERS --- */
        #chaos-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -3; background: #000; }
        #magic-dust { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; mix-blend-mode: screen; }

        .glass-panel {
            background: rgba(5, 5, 5, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            transition: all 0.4s ease;
        }

        .text-gold-glow {
            color: transparent;
            background: linear-gradient(to bottom, #FFFFFF, #F9F1D8, #D4AF37);
            -webkit-background-clip: text;
            text-shadow: 0 10px 30px rgba(0, 0, 0, 0.9);
        }

        /* --- TAROT CARDS (ORIGINAL DESIGN) --- */
        .tarot-card-wrapper { perspective: 1200px; }
        .tarot-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform-style: preserve-3d; }
        .flipped .tarot-card-inner { transform: rotateY(180deg); }
        .card-face { position: absolute; inset: 0; backface-visibility: hidden; border-radius: 12px; border: 2px solid #997B1E; overflow: hidden; }
        
        .card-front-design {
            background: #0a0500;
            background-image: radial-gradient(circle at 50% 50%, rgba(212, 175, 55, 0.15) 0%, transparent 60%);
            display: flex; align-items: center; justify-content: center;
        }
        
        .eye-symbol {
            width: 60px; height: 60px;
            border: 2px solid #D4AF37; border-radius: 0 70%; transform: rotate(45deg);
            position: relative; box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }
        .eye-symbol::after {
            content: ''; position: absolute; width: 24px; height: 24px;
            background: #D4AF37; border-radius: 50%; top: 50%; left: 50%;
            transform: translate(-50%, -50%); box-shadow: 0 0 10px #D4AF37;
        }

        .card-back { background: #000; transform: rotateY(180deg); display: flex; flex-direction: column; align-items: center; justify-content: center; border-color: #D4AF37; }

        /* --- MYSTICAL PORTAL (RESTORED) --- */
        .portal-container {
            position: relative; width: 220px; height: 220px; margin: 0 auto;
            display: flex; align-items: center; justify-content: center;
        }
        .portal-ring {
            position: absolute; inset: 0; border-radius: 50%;
            border: 2px solid transparent; border-top-color: #D4AF37; border-bottom-color: #997B1E;
            animation: spin 10s linear infinite; filter: drop-shadow(0 0 10px #D4AF37);
        }
        .portal-ring:nth-child(2) {
            inset: 15px; border-left-color: #333; border-right-color: #666;
            animation: spin 7s linear infinite reverse; border-top-color: transparent; border-bottom-color: transparent;
        }
        .portal-core {
            width: 150px; height: 150px;
            background: radial-gradient(circle, #000000 30%, #1a1a1a 100%);
            border-radius: 50%; position: relative; z-index: 10;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.2); transition: all 0.5s ease;
        }
        .portal-mist {
            position: absolute; inset: -50%;
            background: conic-gradient(transparent, rgba(212, 175, 55, 0.3), transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: spin 4s linear infinite; filter: blur(20px);
        }
        .portal-container:hover .portal-core { box-shadow: 0 0 60px rgba(212, 175, 55, 0.4); transform: scale(1.05); }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* --- UI ELEMENTS --- */
        .btn-gold {
            background: transparent; border: 1px solid #D4AF37; color: #D4AF37; padding: 12px 24px;
            font-family: 'Cinzel Decorative', serif; transition: all 0.4s ease;
            cursor: pointer;
        }
        .btn-gold:hover { background: #D4AF37; color: #000; box-shadow: 0 0 30px rgba(212, 175, 55, 0.5); }

        .input-gold {
            width: 100%; background: rgba(0,0,0,0.6); border: 1px solid rgba(212, 175, 55, 0.3);
            color: #F9F1D8; padding: 12px; border-radius: 8px; outline: none;
        }

        ::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; opacity: 0.7; }

        .time-slot {
            padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 6px;
            text-align: center; cursor: pointer; transition: all 0.3s; color: #E6C87C;
        }
        .time-slot.selected { background: #D4AF37; color: #000; font-weight: bold; }
        .time-slot.disabled { opacity: 0.2; cursor: not-allowed; text-decoration: line-through; }

        /* --- BUTTERFLY --- */
        .magical-scene { height: 140px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px; }
        .butterfly-container { position: relative; width: 80px; height: 80px; animation: b-hover 4s ease-in-out infinite; }
        .butterfly { width: 100%; height: 100%; transform-style: preserve-3d; }
        .wing { position: absolute; width: 50px; height: 70px; background: radial-gradient(circle at 0% 50%, #D4AF37, transparent); border-radius: 50% 50% 0 50%; opacity: 0.8; }
        .wing.left { left: -5px; transform-origin: right center; animation: w-flap-l 1.5s ease-in-out infinite; }
        .wing.right { right: -5px; transform-origin: left center; transform: scaleX(-1); animation: w-flap-r 1.5s ease-in-out infinite; }
        .b-body { position: absolute; left: 50%; top: 25px; width: 4px; height: 40px; background: #fff; transform: translateX(-50%); border-radius: 10px; box-shadow: 0 0 15px gold; }
        @keyframes w-flap-l { 0%, 100% { transform: rotateY(0deg); } 50% { transform: rotateY(70deg); } }
        @keyframes w-flap-r { 0%, 100% { transform: scaleX(-1) rotateY(0deg); } 50% { transform: scaleX(-1) rotateY(70deg); } }
        @keyframes b-hover { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        /* --- GALLERY SCROLL --- */
        .gallery-scroll { scrollbar-width: none; -ms-overflow-style: none; }
        .gallery-scroll::-webkit-scrollbar { display: none; }

    </style>
</head>
<body class="min-h-screen flex flex-col font-body selection:bg-gold-500 selection:text-black">

    <!-- PRELOADER -->
    <div id="preloader" class="fixed inset-0 z-[9999] bg-black flex items-center justify-center">
        <div class="text-center">
            <i class="fas fa-moon text-6xl text-gold-500 animate-pulse mb-4"></i>
            <h2 class="font-heading text-2xl text-gold-100 tracking-widest">Tarot Soul</h2>
        </div>
    </div>

    <div id="custom-cursor"></div>
    
    <!-- DUAL LAYER BACKGROUND -->
    <canvas id="chaos-bg"></canvas>
    <canvas id="magic-dust"></canvas>

    <!-- HEADER -->
    <header class="fixed w-full z-50 top-0 left-0 bg-void/80 backdrop-blur-md border-b border-white/5 py-4">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <i class="fas fa-moon text-gold-500 text-xl"></i>
                <span class="font-heading text-xl text-gold-300 tracking-wider">Tarot Soul</span>
            </div>
            <a href="#booking-section" class="btn-gold rounded-full text-xs font-bold tracking-widest uppercase">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</a>
        </div>
    </header>

    <!-- HERO SECTION -->
    <section class="min-h-screen flex flex-col items-center justify-center text-center px-4 relative pt-20">
        <div class="absolute top-1/4 left-10 opacity-20 text-gold-700 text-6xl animate-bounce" style="animation-duration: 6s">‚òæ</div>
        <div class="absolute bottom-1/4 right-10 opacity-20 text-gold-700 text-6xl animate-bounce" style="animation-duration: 8s">üúÅ</div>
        <h1 class="font-heading text-5xl md:text-8xl text-gold-glow animate-pulse" style="animation-duration: 4s">–¢–∞—Ä–æ —Å –î—É—à–æ–π</h1>
        <p class="text-xl md:text-2xl text-gold-100 italic max-w-2xl font-light mb-12">"–¢–∞–º, –≥–¥–µ –¢—å–º–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–æ –°–≤–µ—Ç–æ–º, —Ä–æ–∂–¥–∞–µ—Ç—Å—è –ò—Å—Ç–∏–Ω–∞."</p>
        <div class="animate-bounce text-gold-500/50 mt-10"><i class="fas fa-chevron-down text-2xl"></i></div>
    </section>

    <!-- MAIN CONTENT -->
    <div class="container mx-auto px-4 pb-20 max-w-5xl space-y-32 relative z-10">

        <!-- 1. CARDS -->
        <section>
            <div class="text-center mb-12">
                <h2 class="font-heading text-3xl md:text-4xl text-gold-300">–ó–æ–ª–æ—Ç–æ–π –†–∞—Å–∫–ª–∞–¥</h2>
                <p class="text-xs uppercase tracking-widest text-gray-500">–ü—Ä–∏–∫–æ—Å–Ω–∏—Å—å –∫ —Å–≤–æ–µ–π —Å—É–¥—å–±–µ</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 h-[400px]" id="tarot-deck"></div>
            <div id="tarot-result" class="hidden glass-panel p-8 mt-8 text-center max-w-2xl mx-auto border-gold-500/30">
                <div class="text-6xl text-gold-500 mb-4"><i id="result-icon" class=""></i></div>
                <h3 id="result-title" class="font-heading text-3xl text-gold-100 mb-4"></h3>
                <p id="result-desc" class="text-lg text-gray-300 italic mb-8"></p>
                <button onclick="window.resetTarot()" class="btn-gold rounded-full text-sm">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
            </div>
        </section>

        <!-- 2. PORTAL (RESTORED VISUALS) -->
        <section class="flex flex-col items-center">
            <h2 class="font-heading text-3xl text-gold-300 mb-8 font-heading">–ü–æ—Ä—Ç–∞–ª –û—Ç–≤–µ—Ç–æ–≤</h2>
            <div class="portal-container cursor-pointer" onclick="window.activatePortal()">
                <div class="portal-ring"></div>
                <div class="portal-ring"></div>
                <div class="portal-core">
                    <div class="portal-mist" id="portal-mist"></div>
                    <span id="portal-text" class="relative z-20 font-heading text-3xl text-white drop-shadow-[0_0_10px_white]">?</span>
                </div>
            </div>
            <p class="mt-6 text-xs text-gold-700 tracking-[0.3em] uppercase opacity-50">–ù–∞–∂–º–∏ –Ω–∞ —Å—Ñ–µ—Ä—É</p>
        </section>

        <!-- 3. BOOKING SECTION -->
        <section id="booking-section" class="scroll-mt-24">
            <div class="text-center mb-12">
                <h2 class="font-heading text-3xl md:text-4xl text-gold-300">–†–∞—Å–∫–ª–∞–¥ –∑–∞ –î–æ–Ω–∞—Ç</h2>
                <p class="text-sm text-gray-400 uppercase tracking-widest">–û–ø–ª–∞—Ç–∞ –ø–æ —Å–µ—Ä–¥—Ü—É</p>
            </div>

            <div class="glass-panel p-10 text-center max-w-4xl mx-auto mb-16">
                <i class="fas fa-hand-holding-heart text-5xl text-gold-500 mb-6"></i>
                <h3 class="text-2xl font-heading text-gold-100 mb-4">–û—Ç–≤–µ—Ç—ã –í—Å–µ–ª–µ–Ω–Ω–æ–π</h3>
                <p class="text-gray-300 text-lg font-light leading-relaxed mb-8">
                    –†–∞–∑–±–æ—Ä –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏. –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç –∏ —Ñ–æ—Ç–æ –∫–∞—Ä—Ç. –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ –≤—ã —Å–∞–º–∏ –ø–æ –æ—Ç–∫–ª–∏–∫—É –≤ —Å–µ—Ä–¥—Ü–µ.
                </p>
                <div class="flex flex-wrap justify-center gap-6 text-xs text-gold-700 font-bold uppercase tracking-widest">
                    <span><i class="fas fa-check mr-2"></i>–¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç</span>
                    <span><i class="fas fa-check mr-2"></i>–§–æ—Ç–æ –∫–∞—Ä—Ç</span>
                    <span><i class="fas fa-check mr-2"></i>–ß–µ—Å—Ç–Ω–æ—Å—Ç—å</span>
                </div>
            </div>

            <div class="glass-panel p-8 max-w-3xl mx-auto">
                <form id="booking-form" class="space-y-8" onsubmit="window.submitBooking(event)">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <input type="text" id="book-name" required class="input-gold" placeholder="–í–∞—à–µ –ò–º—è">
                        <input type="text" id="book-contact" required class="input-gold" placeholder="Telegram @username (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <label class="block text-gold-300 text-xs uppercase mb-2 text-center tracking-widest">–î–∞—Ç–∞</label>
                            <input type="date" id="book-date" required class="input-gold text-center cursor-pointer" onchange="window.generateTimeSlots(this.value)">
                        </div>
                        <div>
                             <label class="block text-gold-300 text-xs uppercase mb-2 text-center tracking-widest">–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è</label>
                             <div id="time-slots-container" class="grid grid-cols-3 gap-2">
                                 <div class="col-span-3 text-center text-gray-600 text-sm py-2">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</div>
                             </div>
                             <input type="hidden" id="selected-time" required>
                             <p id="time-error" class="text-red-500 text-xs mt-1 hidden text-center">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</p>
                        </div>
                    </div>
                    <textarea id="book-notes" rows="3" class="input-gold" placeholder="–í–∞—à –≤–æ–ø—Ä–æ—Å..."></textarea>
                    <button type="submit" class="w-full btn-gold rounded-lg font-heading text-lg font-bold">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É</button>
                </form>
            </div>
        </section>

        <!-- 4. REVIEWS (ARROWS ON SIDES) -->
        <section class="relative">
            <h2 class="font-heading text-3xl text-center text-gold-300 mb-12">–ö–Ω–∏–≥–∞ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏</h2>
            
            <div class="relative group">
                <!-- Side Arrows -->
                <button onclick="window.scrollGallery(-1)" class="absolute -left-4 md:-left-12 top-1/2 -translate-y-1/2 z-20 bg-void/80 border border-gold-500/30 text-gold-500 w-10 h-10 md:w-14 md:h-14 rounded-full hover:bg-gold-500 hover:text-black transition-all flex items-center justify-center cursor-pointer shadow-xl">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button onclick="window.scrollGallery(1)" class="absolute -right-4 md:-right-12 top-1/2 -translate-y-1/2 z-20 bg-void/80 border border-gold-500/30 text-gold-500 w-10 h-10 md:w-14 md:h-14 rounded-full hover:bg-gold-500 hover:text-black transition-all flex items-center justify-center cursor-pointer shadow-xl">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <div id="gallery-container" class="flex overflow-x-auto gap-6 pb-8 gallery-scroll snap-x scroll-pl-4">
                    <div class="snap-center shrink-0 w-72 h-[480px] glass-panel p-2 cursor-pointer group/item" onclick="window.openImageModal(this)">
                        <img src="photo_2026-01-16_12-10-08.jpg" class="w-full h-full object-cover rounded-lg group-hover/item:opacity-80 transition" onerror="this.src='https://placehold.co/300x500/111/D4AF37?text=–û—Ç–∑—ã–≤+1'">
                    </div>
                    <div class="snap-center shrink-0 w-72 h-[480px] glass-panel p-2 cursor-pointer group/item" onclick="window.openImageModal(this)">
                        <img src="photo_2026-01-16_12-10-09.jpg" class="w-full h-full object-cover rounded-lg group-hover/item:opacity-80 transition" onerror="this.src='https://placehold.co/300x500/111/D4AF37?text=–û—Ç–∑—ã–≤+2'">
                    </div>
                    <div class="snap-center shrink-0 w-72 h-[480px] glass-panel p-2 cursor-pointer group/item" onclick="window.openImageModal(this)">
                        <img src="photo_2026-01-16_12-10-10.jpg" class="w-full h-full object-cover rounded-lg group-hover/item:opacity-80 transition" onerror="this.src='https://placehold.co/300x500/111/D4AF37?text=–û—Ç–∑—ã–≤+3'">
                    </div>
                    <div class="snap-center shrink-0 w-72 h-[480px] glass-panel p-2 cursor-pointer group/item" onclick="window.openImageModal(this)">
                        <img src="photo_2026-01-16_12-10-11.jpg" class="w-full h-full object-cover rounded-lg group-hover/item:opacity-80 transition" onerror="this.src='https://placehold.co/300x500/111/D4AF37?text=–û—Ç–∑—ã–≤+4'">
                    </div>
                </div>
            </div>

            <div id="reviews-list" class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-12"></div>
            <div class="text-center mt-12"><button onclick="window.openReviewModal()" class="btn-gold rounded-full text-xs font-bold tracking-widest uppercase">–û—Å—Ç–∞–≤–∏—Ç—å –û—Ç–∑—ã–≤</button></div>
        </section>

    </div>

    <!-- FOOTER -->
    <footer class="border-t border-white/5 bg-black py-12 text-center relative z-10">
        <div class="text-gold-700 text-2xl font-heading mb-4">Tarot Soul</div>
        <p class="text-gray-700 text-xs uppercase tracking-widest">&copy; 2026 –ï–ª–µ–Ω–∞. –°–¥–µ–ª–∞–Ω–æ —Å –¥—É—à–æ–π.</p>
    </footer>

    <!-- MODALS -->
    <div id="success-modal" class="fixed inset-0 z-[120] hidden bg-black/95 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="glass-panel w-full max-w-sm p-8 text-center relative shadow-[0_0_50px_rgba(212,175,55,0.2)] border-gold-500/50">
            <button onclick="document.getElementById('success-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-500 hover:text-white transition"><i class="fas fa-times text-xl"></i></button>
            <div class="magical-scene">
                <div class="butterfly-container"><div class="butterfly"><div class="wing left"></div><div class="b-body"></div><div class="wing right"></div></div></div>
            </div>
            <h3 class="font-heading text-2xl text-gold-300 mb-2">–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ!</h3>
            <p class="text-gray-300 text-sm mb-8 leading-relaxed">–ß—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å, <span class="text-white font-bold">–æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram</span>. –Ø –∂–¥—É –≤–∞—Å!</p>
            <button id="success-telegram-btn" class="w-full btn-gold rounded-lg font-bold uppercase animate-pulse shadow-gold-500/20">–ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram</button>
        </div>
    </div>

    <div id="review-modal" class="fixed inset-0 z-[100] hidden bg-black/80 flex items-center justify-center p-4">
        <div class="glass-panel w-full max-w-md p-8 relative">
            <button onclick="window.closeReviewModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white transition"><i class="fas fa-times text-xl"></i></button>
            <h3 class="font-heading text-2xl text-gold-300 mb-6 text-center tracking-wider">–í–∞—à –û—Ç–∑—ã–≤</h3>
            <form onsubmit="window.submitReview(event)" class="space-y-4">
                <input type="text" id="review-name" placeholder="–ò–º—è" required class="input-gold">
                <textarea id="review-text" rows="4" placeholder="–í–∞—à–∏ —Å–ª–æ–≤–∞..." required class="input-gold"></textarea>
                <div class="flex justify-center gap-2 text-2xl mb-4" id="star-rating">
                    <i class="fas fa-star text-gold-300 cursor-pointer" onclick="window.setRating(1)"></i>
                    <i class="fas fa-star text-gold-300 cursor-pointer" onclick="window.setRating(2)"></i>
                    <i class="fas fa-star text-gold-300 cursor-pointer" onclick="window.setRating(3)"></i>
                    <i class="fas fa-star text-gold-300 cursor-pointer" onclick="window.setRating(4)"></i>
                    <i class="fas fa-star text-gold-300 cursor-pointer" onclick="window.setRating(5)"></i>
                </div>
                <button type="submit" class="w-full btn-gold rounded-lg uppercase text-xs font-bold tracking-widest">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <div id="image-modal" class="fixed inset-0 z-[110] hidden bg-black/95 flex items-center justify-center p-4 cursor-pointer" onclick="window.closeImageModal()">
        <img id="modal-image" src="" alt="Full Review" class="max-h-[90vh] max-w-full rounded-lg border border-gold-500/30 shadow-2xl">
    </div>

    <!-- FIREBASE & CORE LOGIC -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, getDocs } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

        let db = null;
        let auth = null;
        let user = null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'oracle-soul-tarot';

        const initAuth = async () => {
            try {
                const configStr = typeof __firebase_config !== 'undefined' ? __firebase_config : null;
                if (configStr) {
                    const config = JSON.parse(configStr);
                    const app = initializeApp(config);
                    auth = getAuth(app);
                    db = getFirestore(app);

                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }

                    onAuthStateChanged(auth, (u) => {
                        user = u;
                        if (u) loadReviews();
                    });
                }
            } catch (e) { console.warn("Demo mode."); }
        };

        window.generateTimeSlots = async function(dateString) {
            const container = document.getElementById('time-slots-container');
            const hiddenInput = document.getElementById('selected-time');
            if(!container) return;

            container.innerHTML = '<div class="col-span-3 text-center text-gold-500 text-xs py-2"><i class="fas fa-spinner fa-spin"></i> –ü—Ä–æ–≤–µ—Ä—è–µ–º...</div>';
            hiddenInput.value = '';

            let bookedTimes = [];
            if (db && user) {
                try {
                    const snap = await getDocs(collection(db, 'artifacts', appId, 'public', 'data', 'bookings'));
                    snap.forEach(docSnap => {
                        const d = docSnap.data();
                        if (d.date === dateString) bookedTimes.push(d.time);
                    });
                } catch (e) { console.error("Firebase error"); }
            }

            container.innerHTML = '';
            const now = new Date();
            const todayStr = now.toISOString().split('T')[0];
            const hourNow = now.getHours();

            for(let h = 11; h <= 19; h++) {
                const timeStr = `${h}:00`;
                const isPast = (dateString === todayStr && h <= hourNow);
                const isBooked = bookedTimes.includes(timeStr);
                const isDisabled = isPast || isBooked;

                const slot = document.createElement('div');
                slot.className = `time-slot ${isDisabled ? 'disabled' : ''}`;
                slot.innerText = timeStr;
                
                if(!isDisabled) {
                    slot.onclick = () => {
                        Array.from(container.children).forEach(c => c.classList.remove('selected'));
                        slot.classList.add('selected');
                        hiddenInput.value = timeStr;
                        document.getElementById('time-error').classList.add('hidden');
                    };
                }
                container.appendChild(slot);
            }
        };

        window.submitBooking = async function(e) {
            e.preventDefault();
            const time = document.getElementById('selected-time').value;
            const handle = document.getElementById('book-contact').value;
            if(!time) { document.getElementById('time-error').classList.remove('hidden'); return; }

            const data = {
                name: document.getElementById('book-name').value,
                contact: handle,
                date: document.getElementById('book-date').value,
                time: time,
                notes: document.getElementById('book-notes').value,
                createdAt: serverTimestamp() || new Date()
            };

            if (db && user) { try { await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'bookings'), data); } catch(err) {} }

            const msg = `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ï–ª–µ–Ω–∞!%0A%0A–•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å–∫–ª–∞–¥:%0A–ò–º—è: ${data.name}%0ATelegram: ${handle}%0A–î–∞—Ç–∞: ${data.date}%0A–í—Ä–µ–º—è: ${data.time}%0A–ó–∞–ø—Ä–æ—Å: ${data.notes}`;
            const link = `https://t.me/elena_soul_tarot?text=${msg}`;
            
            document.getElementById('success-telegram-btn').onclick = () => window.open(link, '_blank');
            document.getElementById('success-modal').classList.remove('hidden');
            e.target.reset();
            document.getElementById('time-slots-container').innerHTML = '<div class="col-span-3 text-center text-gray-600 text-sm py-2">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</div>';
        };

        function loadReviews() {
            if (!db || !user) return;
            onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'reviews'), (snap) => {
                const list = document.getElementById('reviews-list');
                if(!list) return;
                let html = '';
                snap.forEach(docSnap => {
                    const r = docSnap.data();
                    html += `<div class="glass-panel p-6 animate-float" style="animation-duration: ${Math.random()*2+4}s">
                        <div class="flex justify-between items-center mb-4">
                            <span class="font-bold text-white">${r.name}</span>
                            <div class="text-gold-300 text-xs">${"‚òÖ".repeat(r.rating || 5)}</div>
                        </div>
                        <p class="text-gray-400 italic text-sm">"${r.text}"</p>
                    </div>`;
                });
                if (html) list.innerHTML = html;
            });
        }

        window.submitReview = async function(e) {
            e.preventDefault();
            if(!db || !user) { alert("–î–µ–º–æ-—Ä–µ–∂–∏–º."); window.closeReviewModal(); return; }
            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'reviews'), {
                    name: document.getElementById('review-name').value,
                    text: document.getElementById('review-text').value,
                    rating: window.currentRating || 5,
                    createdAt: serverTimestamp()
                });
                window.closeReviewModal();
                e.target.reset();
            } catch(err) { console.error(err); }
        };

        initAuth();
    </script>

    <!-- VISUAL SCRIPTS (BACKGROUNDS, CURSOR, CARDS, PORTAL) -->
    <script>
        window.addEventListener('load', () => { 
            setTimeout(() => { document.getElementById('preloader').classList.add('loaded'); }, 500); 
            const dIn = document.getElementById('book-date');
            if (dIn) dIn.min = new Date().toISOString().split('T')[0];
        });

        // 1. DUAL CANVAS BACKGROUNDS
        const chaosCanvas = document.getElementById('chaos-bg');
        const chaosCtx = chaosCanvas.getContext('2d');
        const dustCanvas = document.getElementById('magic-dust');
        const dustCtx = dustCanvas.getContext('2d');
        let canvW, canvH, energyBlobs = [], sparkles = [];

        function initCanvases() {
            canvW = chaosCanvas.width = dustCanvas.width = window.innerWidth;
            canvH = chaosCanvas.height = dustCanvas.height = window.innerHeight;
            energyBlobs = Array.from({length: 8}, () => ({
                x: Math.random()*canvW, y: Math.random()*canvH, r: Math.random()*250+150,
                vx: (Math.random()-0.5)*0.6, vy: (Math.random()-0.5)*0.6,
                c: Math.random() > 0.5 ? 'rgba(212, 175, 55, 0.12)' : 'rgba(255, 255, 255, 0.05)'
            }));
        }

        class Sparkle {
            constructor(x, y, fromMouse) {
                this.x = x || Math.random()*canvW;
                this.y = y || (fromMouse ? y : Math.random()*canvH);
                this.speedX = (Math.random()-0.5) * 2;
                this.speedY = (Math.random()-0.5) * 2;
                this.size = Math.random() * 2 + 0.5;
                this.life = Math.random() * 100 + 50;
                this.maxLife = this.life;
                this.color = Math.random() > 0.2 ? '#D4AF37' : '#FFFFFF';
            }
            update() { this.x += this.speedX; this.y += this.speedY; this.life--; }
            draw() {
                dustCtx.fillStyle = this.color;
                dustCtx.globalAlpha = this.life / this.maxLife;
                dustCtx.beginPath(); dustCtx.arc(this.x, this.y, this.size, 0, Math.PI*2); dustCtx.fill();
            }
        }

        function animate() {
            chaosCtx.fillStyle = '#000'; chaosCtx.fillRect(0,0,canvW,canvH);
            energyBlobs.forEach(b => {
                b.x += b.vx; b.y += b.vy;
                if(b.x<0 || b.x>canvW) b.vx *= -1; if(b.y<0 || b.y>canvH) b.vy *= -1;
                let g = chaosCtx.createRadialGradient(b.x, b.y, 0, b.x, b.y, b.r);
                g.addColorStop(0, b.c); g.addColorStop(1, 'transparent');
                chaosCtx.fillStyle = g; chaosCtx.beginPath(); chaosCtx.arc(b.x, b.y, b.r, 0, Math.PI*2); chaosCtx.fill();
            });

            dustCtx.clearRect(0,0,canvW,canvH);
            if(sparkles.length < 80) sparkles.push(new Sparkle());
            sparkles.forEach((s, i) => {
                s.update(); s.draw();
                if(s.life <= 0) sparkles.splice(i, 1);
            });

            requestAnimationFrame(animate);
        }
        window.addEventListener('resize', initCanvases);
        initCanvases(); animate();

        // 2. CURSOR & INTERACTIONS
        const cCursor = document.getElementById('custom-cursor');
        document.addEventListener('mousemove', e => {
            if(cCursor) { cCursor.style.left = e.clientX + 'px'; cCursor.style.top = e.clientY + 'px'; }
            if(Math.random() > 0.7) sparkles.push(new Sparkle(e.clientX, e.clientY, true));
        });
        document.querySelectorAll('button, a, input, textarea, .cursor-pointer').forEach(el => {
            el.addEventListener('mouseenter', () => cCursor?.classList.add('active'));
            el.addEventListener('mouseleave', () => cCursor?.classList.remove('active'));
        });

        // 3. TAROT SYSTEM
        const tList = [
            { name: "–°–æ–ª–Ω—Ü–µ", icon: "fas fa-sun", desc: "–ê–±—Å–æ–ª—é—Ç–Ω—ã–π —É—Å–ø–µ—Ö, —è—Å–Ω–æ—Å—Ç—å –≤–æ –≤—Å–µ—Ö –¥–µ–ª–∞—Ö –∏ –±–æ–ª—å—à–∞—è —Ä–∞–¥–æ—Å—Ç—å. –¢—å–º–∞ –æ—Ç—Å—Ç—É–ø–∞–µ—Ç." },
            { name: "–õ—É–Ω–∞", icon: "fas fa-moon", desc: "–í—Ä–µ–º—è –ø—Ä–∏—Å–ª—É—à–∞—Ç—å—Å—è –∫ –∏–Ω—Ç—É–∏—Ü–∏–∏. –í–ø–µ—Ä–µ–¥–∏ –≤–∞–∂–Ω—ã–µ —Ç–∞–π–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–∫–æ—Ä–æ —Ä–∞—Å–∫—Ä–æ—é—Ç—Å—è." },
            { name: "–ó–≤–µ–∑–¥–∞", icon: "fas fa-star", desc: "–í–∞—à–∞ –º–µ—á—Ç–∞ –ø–æ–¥ –∑–∞—â–∏—Ç–æ–π –í—Å–µ–ª–µ–Ω–Ω–æ–π. –ù–∞–¥–µ–∂–¥–∞ –≤–µ–¥–µ—Ç –≤–∞—Å –ø–æ –≤–µ—Ä–Ω–æ–º—É –ø—É—Ç–∏." },
            { name: "–ú–∞–≥", icon: "fas fa-magic", desc: "–£ –≤–∞—Å –µ—Å—Ç—å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –î–µ–π—Å—Ç–≤—É–π—Ç–µ." }
        ];
        function initTarot() {
            const deck = document.getElementById('tarot-deck');
            if(!deck) return;
            deck.innerHTML = '';
            for(let i=0; i<3; i++) {
                const card = document.createElement('div');
                card.className = 'tarot-card-wrapper h-full cursor-pointer group';
                card.innerHTML = `
                    <div class="tarot-card-inner">
                        <div class="card-face card-front-design">
                            <div class="eye-symbol"></div>
                        </div>
                        <div class="card-face card-back"></div>
                    </div>`;
                card.onclick = () => {
                    if(document.querySelector('.flipped')) return;
                    const d = tList[Math.floor(Math.random()*tList.length)];
                    card.classList.add('flipped');
                    card.querySelector('.card-back').innerHTML = `<i class="${d.icon} text-5xl text-gold-500 mb-4"></i><div class="font-heading text-gold-100 text-center px-4">${d.name}</div>`;
                    setTimeout(() => {
                        document.getElementById('result-icon').className = d.icon;
                        document.getElementById('result-title').innerText = d.name;
                        document.getElementById('result-desc').innerText = d.desc;
                        document.getElementById('tarot-result').classList.remove('hidden');
                    }, 600);
                };
                deck.appendChild(card);
            }
        }
        window.resetTarot = () => { document.getElementById('tarot-result').classList.add('hidden'); initTarot(); };
        initTarot();

        // 4. PORTAL (RESTORED LOGIC)
        let isPortalActive = false;
        window.activatePortal = () => {
            if(isPortalActive) return;
            isPortalActive = true;
            
            const pt = document.getElementById('portal-text');
            const mist = document.getElementById('portal-mist');
            const answers = ["–î–ê", "–ù–ï–¢", "–í–ï–†–¨", "–ñ–î–ò", "–®–ê–ù–°"];
            
            pt.style.opacity = '0';
            mist.style.animationDuration = '1s'; // –£—Å–∫–æ—Ä—è–µ–º —Ç—É–º–∞–Ω
            
            setTimeout(() => {
                pt.innerText = answers[Math.floor(Math.random()*answers.length)];
                pt.style.opacity = '1';
                mist.style.animationDuration = '4s';
                isPortalActive = false;
            }, 600);
        };

        // 5. GALLERY & MISC
        window.scrollGallery = function(dir) {
            const container = document.getElementById('gallery-container');
            container.scrollBy({ left: dir * 320, behavior: 'smooth' });
        };
        window.openImageModal = el => {
            const modal = document.getElementById('image-modal');
            const img = el.querySelector('img');
            if (img) { document.getElementById('modal-image').src = img.src; modal.classList.remove('hidden'); }
        };
        window.closeImageModal = () => document.getElementById('image-modal').classList.add('hidden');
        window.openReviewModal = () => document.getElementById('review-modal').classList.remove('hidden');
        window.closeReviewModal = () => document.getElementById('review-modal').classList.add('hidden');
        
        window.currentRating = 5;
        window.setRating = r => {
            window.currentRating = r;
            const stars = document.getElementById('star-rating').children;
            for(let i=0; i<5; i++) { stars[i].style.color = i < r ? "#fcd34d" : "#444"; stars[i].style.opacity = i < r ? "1" : "0.5"; }
        };
    </script>
</body>
</html>
