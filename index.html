<!DOCTYPE html>
<html lang="ru" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞—Ä–æ —Å –î—É—à–æ–π | –ï–ª–µ–Ω–∞</title>
    <!-- FAVICON (–õ—É–Ω–∞) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåô</text></svg>">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        void: '#020202', 
                        gold: {
                            100: '#F9F1D8',
                            300: '#E6C87C',
                            500: '#D4AF37', 
                            700: '#997B1E',
                            900: '#423206',
                        },
                    },
                    fontFamily: {
                        heading: ['Cinzel Decorative', 'serif'],
                        body: ['Cormorant Garamond', 'serif'],
                    },
                    backgroundImage: {
                        'gold-gradient': 'linear-gradient(135deg, #D4AF37 0%, #F9F1D8 50%, #997B1E 100%)',
                    },
                    animation: {
                        'spin-slow': 'spin 12s linear infinite',
                        'pulse-gold': 'pulseGold 3s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                    },
                    keyframes: {
                        pulseGold: {
                            '0%, 100%': { boxShadow: '0 0 10px rgba(212, 175, 55, 0.2)' },
                            '50%': { boxShadow: '0 0 25px rgba(212, 175, 55, 0.6)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-200% center' },
                            '100%': { backgroundPosition: '200% center' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #000000;
            color: #E6C87C;
            overflow-x: hidden;
            cursor: none; 
            position: relative;
        }

        @media (hover: none) and (pointer: coarse) {
            body { cursor: auto !important; }
            #custom-cursor { display: none !important; }
            .btn-gold, .portal-container, .glass-panel, .cursor-pointer, input, textarea, button { cursor: pointer !important; }
        }

        #custom-cursor {
            position: fixed;
            width: 20px; height: 20px;
            background: radial-gradient(circle, #fff 0%, #D4AF37 50%, transparent 80%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px 5px rgba(212, 175, 55, 0.6);
            mix-blend-mode: screen;
            transition: width 0.2s, height 0.2s;
        }
        #custom-cursor.active {
            width: 40px; height: 40px;
            box-shadow: 0 0 40px 10px rgba(255, 215, 0, 0.8);
        }

        #preloader {
            transition: opacity 0.8s ease-out, visibility 0.8s;
        }
        #preloader.loaded {
            opacity: 0;
            visibility: hidden;
        }

        #chaos-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -3; background: #000;
        }
        #magic-dust {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; mix-blend-mode: screen;
        }

        .glass-panel {
            background: rgba(5, 5, 5, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.9), inset 0 0 20px rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        .glass-panel::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.5), transparent);
        }
        .glass-panel:hover {
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.15);
            transform: translateY(-5px);
        }

        .text-gold-glow {
            color: transparent;
            background: linear-gradient(to bottom, #FFFFFF, #F9F1D8, #D4AF37);
            -webkit-background-clip: text; background-clip: text;
            text-shadow: 0 10px 30px rgba(0, 0, 0, 0.9), 0 0 40px rgba(212, 175, 55, 0.4);
            filter: drop-shadow(0 2px 4px rgba(0,0,0,1));
            position: relative; z-index: 10;
        }

        .tarot-card-wrapper { perspective: 1200px; }
        .tarot-card-inner {
            position: relative; width: 100%; height: 100%;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.8);
        }
        .flipped .tarot-card-inner { transform: rotateY(180deg); }
        .card-face {
            position: absolute; inset: 0; backface-visibility: hidden; border-radius: 12px; border: 2px solid #997B1E;
        }
        .card-front {
            background: #0a0500;
            background-image: radial-gradient(circle at 50% 50%, rgba(212, 175, 55, 0.1) 0%, transparent 60%);
            display: flex; align-items: center; justify-content: center;
        }
        .eye-symbol {
            width: 60px; height: 60px;
            border: 2px solid #D4AF37; border-radius: 0 70%; transform: rotate(45deg);
            position: relative; box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }
        .eye-symbol::after {
            content: ''; position: absolute; width: 24px; height: 24px;
            background: #D4AF37; border-radius: 50%; top: 50%; left: 50%;
            transform: translate(-50%, -50%); box-shadow: 0 0 10px #D4AF37;
        }
        .card-back {
            background: linear-gradient(160deg, #1a1a1a 0%, #000000 100%);
            transform: rotateY(180deg);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-color: #D4AF37;
        }

        .portal-container {
            position: relative; width: 200px; height: 200px; margin: 0 auto;
            display: flex; align-items: center; justify-content: center;
        }
        .portal-ring {
            position: absolute; inset: 0; border-radius: 50%;
            border: 2px solid transparent; border-top-color: #D4AF37; border-bottom-color: #997B1E;
            animation: spin 8s linear infinite; filter: drop-shadow(0 0 10px #D4AF37);
        }
        .portal-ring:nth-child(2) {
            inset: 15px; border-left-color: #333; border-right-color: #666;
            animation: spin 6s linear infinite reverse; border-top-color: transparent; border-bottom-color: transparent;
        }
        .portal-core {
            width: 140px; height: 140px;
            background: radial-gradient(circle, #000000 30%, #1a1a1a 100%);
            border-radius: 50%; position: relative; z-index: 10;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.1); transition: all 0.5s ease;
        }
        .portal-mist {
            position: absolute; inset: -50%;
            background: conic-gradient(transparent, rgba(212, 175, 55, 0.3), transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: spin 4s linear infinite; filter: blur(20px);
        }
        .portal-container:hover .portal-core { box-shadow: 0 0 80px rgba(212, 175, 55, 0.4); transform: scale(1.05); }

        .btn-gold {
            background: transparent; border: 1px solid #D4AF37; color: #D4AF37;
            position: relative; overflow: hidden; transition: all 0.4s ease;
            font-family: 'Cinzel Decorative', serif; letter-spacing: 0.1em; z-index: 1;
        }
        .btn-gold::before {
            content: ''; position: absolute; top: 0; left: 0; width: 0%; height: 100%;
            background: #D4AF37; transition: all 0.4s ease; z-index: -1;
        }
        .btn-gold:hover::before { width: 100%; }
        .btn-gold:hover { color: #000; box-shadow: 0 0 30px rgba(212, 175, 55, 0.5); }

        .gallery-scroll::-webkit-scrollbar { height: 0px; background: transparent; }
        .gallery-scroll { scrollbar-width: none; }

        #review-modal, #image-modal, #success-modal { backdrop-filter: blur(10px); cursor: auto !important; }
        #review-modal *, #image-modal *, #success-modal * { cursor: auto !important; }

        .input-gold {
            width: 100%;
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: #F9F1D8;
            padding: 12px;
            border-radius: 8px;
            outline: none;
            transition: all 0.3s;
        }
        ::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }
        .input-gold:focus {
            border-color: #D4AF37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }
        
        .time-slot {
            padding: 10px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            background: rgba(0,0,0,0.3);
            transition: all 0.3s;
            font-size: 0.9rem;
            color: #E6C87C;
        }
        .time-slot:hover:not(.disabled) {
            border-color: #D4AF37;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
            background: rgba(212, 175, 55, 0.1);
        }
        .time-slot.selected {
            background: #D4AF37;
            color: #000;
            border-color: #D4AF37;
            font-weight: bold;
        }
        .time-slot.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            border-color: rgba(255,255,255,0.05);
            background: rgba(0,0,0,0.5);
            text-decoration: line-through;
        }

        .magical-scene {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-bottom: 10px;
        }

        .butterfly-container {
            position: relative;
            width: 80px;
            height: 80px;
            animation: butterfly-hover 4s ease-in-out infinite;
        }

        .butterfly {
            width: 100%; height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(20deg) rotateY(10deg);
        }

        .wing {
            position: absolute; top: 10px;
            width: 50px; height: 70px;
            background: radial-gradient(circle at 0% 50%, rgba(212, 175, 55, 0.95), transparent);
            border-radius: 50% 50% 0 50%;
            border: 1px solid rgba(255, 255, 255, 0.5);
            filter: drop-shadow(0 0 10px gold);
            opacity: 0.9;
        }

        .wing.left { left: -5px; transform-origin: right center; animation: wing-flap-left 1.5s ease-in-out infinite; }
        .wing.right { right: -5px; transform-origin: left center; transform: scaleX(-1); animation: wing-flap-right 1.5s ease-in-out infinite; }

        .butterfly-body {
            position: absolute; left: 50%; top: 25px;
            width: 4px; height: 40px;
            background: #fff; transform: translateX(-50%);
            border-radius: 10px; box-shadow: 0 0 15px gold;
        }

        @keyframes wing-flap-left { 0%, 100% { transform: rotateY(0deg); } 50% { transform: rotateY(70deg); } }
        @keyframes wing-flap-right { 0%, 100% { transform: scaleX(-1) rotateY(0deg); } 50% { transform: scaleX(-1) rotateY(70deg); } }
        @keyframes butterfly-hover { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-15px) rotate(3deg); } }

    </style>
</head>
<body class="min-h-screen flex flex-col font-body selection:bg-gold-500 selection:text-black">

    <!-- PRELOADER -->
    <div id="preloader" class="fixed inset-0 z-[9999] bg-black flex items-center justify-center">
        <div class="text-center">
            <i class="fas fa-moon text-6xl text-gold-500 animate-pulse-gold mb-4"></i>
            <h2 class="font-heading text-2xl text-gold-100 tracking-widest animate-shimmer">Tarot Soul</h2>
        </div>
    </div>

    <!-- CUSTOM CURSOR -->
    <div id="custom-cursor"></div>

    <!-- BACKGROUNDS -->
    <canvas id="chaos-bg"></canvas>
    <canvas id="magic-dust"></canvas>

    <!-- HEADER -->
    <header class="fixed w-full z-50 top-0 left-0 bg-void/80 backdrop-blur-md border-b border-white/5 transition-all duration-300" id="navbar">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <i class="fas fa-moon text-gold-500 text-xl animate-pulse-gold"></i>
                <span class="font-heading text-xl text-gold-300 tracking-wider">Tarot Soul</span>
            </div>
            <a href="#booking-section" class="btn-gold px-6 py-2 rounded-full text-xs font-bold tracking-widest uppercase hover:text-black hover:bg-gold-500 transition-all duration-300 cursor-pointer">
                –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
            </a>
        </div>
    </header>

    <!-- HERO SECTION -->
    <section class="min-h-screen flex flex-col items-center justify-center text-center px-4 relative pt-20">
        <div class="absolute top-1/4 left-10 opacity-20 text-gold-700 text-6xl animate-float" style="animation-delay: 1s;">‚òæ</div>
        <div class="absolute bottom-1/4 right-10 opacity-20 text-gold-700 text-6xl animate-float" style="animation-delay: 2s;">üúÅ</div>

        <div class="relative mb-6">
            <h1 class="font-heading text-5xl md:text-8xl text-gold-glow animate-float relative z-10">
                –¢–∞—Ä–æ —Å –î—É—à–æ–π
            </h1>
        </div>

        <p class="text-xl md:text-2xl text-gold-100 italic max-w-2xl font-light mb-12 relative z-10 drop-shadow-md">
            "–¢–∞–º, –≥–¥–µ –¢—å–º–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–æ –°–≤–µ—Ç–æ–º, —Ä–æ–∂–¥–∞–µ—Ç—Å—è –ò—Å—Ç–∏–Ω–∞."
        </p>
        
        <div class="animate-bounce text-gold-500/50 mt-10 relative z-10">
            <i class="fas fa-chevron-down text-2xl"></i>
        </div>
    </section>

    <!-- MAIN CONTENT -->
    <div class="container mx-auto px-4 pb-20 max-w-5xl space-y-24 relative z-10">

        <!-- 1. CARDS -->
        <section>
            <div class="text-center mb-12">
                <h2 class="font-heading text-3xl md:text-4xl text-gold-300 mb-2">–ó–æ–ª–æ—Ç–æ–π –†–∞—Å–∫–ª–∞–¥</h2>
                <p class="text-sm text-gray-400 uppercase tracking-[0.2em]">–ü—Ä–∏–∫–æ—Å–Ω–∏—Å—å –∫ —Å–≤–æ–µ–π —Å—É–¥—å–±–µ</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 h-[500px] md:h-[400px]" id="tarot-deck"></div>
            <div id="tarot-result" class="hidden glass-panel p-8 mt-8 text-center max-w-2xl mx-auto border-gold-500/30">
                <div class="text-6xl text-gold-500 mb-4 animate-float"><i id="result-icon" class=""></i></div>
                <h3 id="result-title" class="font-heading text-3xl text-gold-100 mb-4"></h3>
                <p id="result-desc" class="text-lg text-gray-300 italic mb-8 leading-relaxed"></p>
                <button onclick="resetTarot()" class="btn-gold px-8 py-3 rounded-full text-sm cursor-pointer">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
            </div>
        </section>

        <!-- 2. PORTAL -->
        <section class="flex flex-col items-center">
            <div class="text-center mb-10">
                <h2 class="font-heading text-3xl md:text-4xl text-gold-300 mb-2">–ü–æ—Ä—Ç–∞–ª –û—Ç–≤–µ—Ç–æ–≤</h2>
                <p class="text-sm text-gray-400 uppercase tracking-[0.2em]">–î–∞ / –ù–µ—Ç</p>
            </div>
            <div class="portal-container cursor-pointer" onclick="activatePortal()" id="portal">
                <div class="portal-ring"></div>
                <div class="portal-ring"></div>
                <div class="portal-core">
                    <div class="portal-mist"></div>
                    <span id="portal-text" class="relative z-20 font-heading text-2xl text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.8)]">?</span>
                </div>
            </div>
            <p class="mt-8 text-gold-500/60 text-sm font-light italic">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç–∞–ª</p>
        </section>

        <!-- 3. MESSAGE -->
        <section class="glass-panel p-10 md:p-16 text-center relative overflow-hidden group">
            <div class="absolute -left-10 -top-10 w-40 h-40 bg-gold-500/10 rounded-full blur-3xl group-hover:bg-gold-500/20 transition duration-1000"></div>
            <i class="fas fa-quote-left text-4xl text-gold-500/20 mb-6 block"></i>
            <div id="message-container" class="min-h-[100px] flex items-center justify-center">
                <p id="daily-msg" class="text-2xl md:text-3xl text-gold-100 font-heading leading-tight">
                    "–í—Å–µ–ª–µ–Ω–Ω–∞—è —É–∂–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞ –¥–ª—è —Ç–µ–±—è –ø–æ–¥–∞—Ä–æ–∫."
                </p>
            </div>
            <button onclick="getNewMessage()" class="mt-10 btn-gold px-10 py-4 rounded-sm uppercase text-xs font-bold tracking-widest cursor-pointer">
                –ü–æ–ª—É—á–∏—Ç—å –ó–Ω–∞–∫
            </button>
        </section>

        <!-- 4. SERVICES & BOOKING -->
        <section id="booking-section" class="scroll-mt-24">
            <div class="text-center mb-12">
                <h2 class="font-heading text-3xl md:text-4xl text-gold-300 mb-2">–†–∞—Å–∫–ª–∞–¥ –∑–∞ –î–æ–Ω–∞—Ç</h2>
                <p class="text-sm text-gray-400 uppercase tracking-[0.2em]">–û–ø–ª–∞—Ç–∞ –ø–æ —Å–µ—Ä–¥—Ü—É</p>
            </div>

            <div class="glass-panel p-10 text-center max-w-4xl mx-auto mb-16 relative overflow-hidden group hover:border-gold-500 transition duration-500">
                <div class="absolute -inset-1 bg-gold-500/5 blur-3xl rounded-full opacity-0 group-hover:opacity-100 transition duration-700"></div>
                <div class="relative z-10">
                    <i class="fas fa-hand-holding-heart text-5xl text-gold-500 mb-6 animate-pulse-gold"></i>
                    <h3 class="text-2xl md:text-3xl font-heading text-gold-100 mb-4">–û—Ç–≤–µ—Ç—ã –í—Å–µ–ª–µ–Ω–Ω–æ–π</h3>
                    <p class="text-gray-300 text-lg font-light leading-relaxed mb-6 max-w-2xl mx-auto">
                        –Ø –≤–µ—Ä—é, —á—Ç–æ –ø–æ–º–æ—â—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–∞–∂–¥–æ–º—É. –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Ä–∞–∑–±–æ—Ä –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –∞ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ —Å–∞–º–∏, –∏—Å—Ö–æ–¥—è –∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –æ—Ç–∫–ª–∏–∫–∞ –≤ —Å–µ—Ä–¥—Ü–µ.
                    </p>
                    <div class="flex flex-wrap justify-center gap-4 text-sm text-gold-700 font-bold uppercase tracking-wider">
                        <span><i class="fas fa-check mr-2"></i>–ü–æ–¥—Ä–æ–±–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç</span>
                        <span><i class="fas fa-check mr-2"></i>–§–æ—Ç–æ –∫–∞—Ä—Ç</span>
                        <span><i class="fas fa-check mr-2"></i>–ß–µ—Å—Ç–Ω–æ—Å—Ç—å</span>
                    </div>
                </div>
            </div>

            <div class="glass-panel p-8 max-w-3xl mx-auto relative border-gold-500/40">
                <div class="text-center mb-8">
                     <h4 class="font-heading text-xl text-gold-300">–ó–∞–ø–∏—Å—å –Ω–∞ –ø—Ä–∏–µ–º</h4>
                     <p class="text-xs text-gray-500 mt-1">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 11:00 –¥–æ 19:00</p>
                </div>

                <form id="booking-form" class="relative z-10 space-y-8" onsubmit="submitBooking(event)">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gold-300 text-xs uppercase tracking-widest mb-2">–í–∞—à–µ –ò–º—è</label>
                            <input type="text" id="book-name" required class="input-gold" placeholder="–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?">
                        </div>
                        <div>
                            <label class="block text-gold-300 text-xs uppercase tracking-widest mb-2">–ö–æ–Ω—Ç–∞–∫—Ç (Telegram)</label>
                            <input type="text" id="book-contact" required class="input-gold" placeholder="@username">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <label class="block text-gold-300 text-xs uppercase tracking-widest mb-2">–í—ã–±–µ—Ä–∏—Ç–µ –î–∞—Ç—É</label>
                            <!-- ADDED ONINPUT FOR BETTER COMPATIBILITY -->
                            <input type="date" id="book-date" required class="input-gold cursor-pointer text-center" oninput="generateTimeSlots(this.value)" onchange="generateTimeSlots(this.value)">
                        </div>
                        <div>
                             <label class="block text-gold-300 text-xs uppercase tracking-widest mb-2">–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è</label>
                             <div id="slots-loader" class="hidden text-center text-gold-500 text-sm py-2">
                                <i class="fas fa-circle-notch fa-spin"></i> –ü—Ä–æ–≤–µ—Ä—è–µ–º...
                             </div>
                             <div id="time-slots-container" class="grid grid-cols-3 gap-2">
                                 <div class="col-span-3 text-center text-gray-600 text-sm py-2">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</div>
                             </div>
                             <input type="hidden" id="selected-time" required>
                             <p id="time-error" class="text-red-500 text-xs mt-1 hidden">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</p>
                        </div>
                    </div>

                    <div>
                        <label class="block text-gold-300 text-xs uppercase tracking-widest mb-2">–í–∞—à –í–æ–ø—Ä–æ—Å</label>
                        <textarea id="book-notes" rows="3" class="input-gold" placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é..."></textarea>
                    </div>

                    <button type="submit" class="w-full btn-gold py-4 rounded-lg font-heading text-lg font-bold hover:bg-gold-500 hover:text-black transition-all">
                        –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É
                    </button>
                </form>
            </div>
        </section>

        <!-- 5. REVIEWS & GALLERY -->
        <section class="relative">
            <div class="text-center mb-12">
                <h2 class="font-heading text-3xl md:text-4xl text-gold-300 mb-2">–ö–Ω–∏–≥–∞ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏</h2>
                <p class="text-sm text-gray-400 uppercase tracking-[0.2em]">–ò—Å—Ç–æ—Ä–∏–∏ –∏ –û—Ç–∑—ã–≤—ã</p>
            </div>
            <div class="mb-16 relative group">
                <button onclick="scrollGallery(-1)" class="absolute left-0 top-1/2 -translate-y-1/2 z-20 bg-black/50 text-gold-500 p-3 rounded-r-lg hover:bg-black/80 hover:text-white transition-all hidden md:block cursor-pointer"><i class="fas fa-chevron-left text-2xl"></i></button>
                <button onclick="scrollGallery(1)" class="absolute right-0 top-1/2 -translate-y-1/2 z-20 bg-black/50 text-gold-500 p-3 rounded-l-lg hover:bg-black/80 hover:text-white transition-all hidden md:block cursor-pointer"><i class="fas fa-chevron-right text-2xl"></i></button>
                <div id="gallery-container" class="flex overflow-x-auto gap-6 py-8 px-4 gallery-scroll snap-x snap-mandatory scroll-pl-4">
                    <div class="snap-center shrink-0 w-72 h-[500px] glass-panel p-2 cursor-pointer transition-all duration-500 transform hover:scale-105 group" onclick="openImageModal(this)"><div class="relative w-full h-full rounded-lg overflow-hidden border border-gold-500/30"><img src="photo_2026-01-16_12-10-08.jpg" alt="–û—Ç–∑—ã–≤ 1" class="w-full h-full object-cover"></div></div>
                    <div class="snap-center shrink-0 w-72 h-[500px] glass-panel p-2 cursor-pointer transition-all duration-500 transform hover:scale-105 group" onclick="openImageModal(this)"><div class="relative w-full h-full rounded-lg overflow-hidden border border-gold-500/30"><img src="photo_2026-01-16_12-10-09.jpg" alt="–û—Ç–∑—ã–≤ 2" class="w-full h-full object-cover"></div></div>
                    <div class="snap-center shrink-0 w-72 h-[500px] glass-panel p-2 cursor-pointer transition-all duration-500 transform hover:scale-105 group" onclick="openImageModal(this)"><div class="relative w-full h-full rounded-lg overflow-hidden border border-gold-500/30"><img src="photo_2026-01-16_12-10-10.jpg" alt="–û—Ç–∑—ã–≤ 3" class="w-full h-full object-cover"></div></div>
                    <div class="snap-center shrink-0 w-72 h-[500px] glass-panel p-2 cursor-pointer transition-all duration-500 transform hover:scale-105 group" onclick="openImageModal(this)"><div class="relative w-full h-full rounded-lg overflow-hidden border border-gold-500/30"><img src="photo_2026-01-16_12-10-11.jpg" alt="–û—Ç–∑—ã–≤ 4" class="w-full h-full object-cover"></div></div>
                </div>
                <p class="text-center text-xs text-gray-500 mt-4 animate-pulse">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å</p>
            </div>
            <div id="reviews-list" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10"></div>
            <div class="text-center">
                <button onclick="openReviewModal()" class="btn-gold px-10 py-4 rounded-full text-sm font-bold tracking-widest uppercase cursor-pointer">–û—Å—Ç–∞–≤–∏—Ç—å –û—Ç–∑—ã–≤</button>
            </div>
        </section>
    </div>

    <!-- FOOTER -->
    <footer class="border-t border-white/5 bg-black py-12 text-center relative z-10">
        <div class="text-gold-700 text-2xl font-heading mb-4">Tarot Soul</div>
        <div class="flex justify-center gap-6 mb-8 text-gray-500">
            <!-- –°–°–´–õ–ö–ê –ù–ê –ë–û–¢–ê –í –§–£–¢–ï–†–ï -->
            <a href="https://t.me/elena_tarot_soul_bot" target="_blank" class="hover:text-gold-500 transition cursor-pointer"><i class="fab fa-telegram text-xl"></i></a>
            <a href="#" class="hover:text-gold-500 transition cursor-pointer"><i class="fab fa-youtube text-xl"></i></a>
        </div>
        <p class="text-gray-700 text-xs uppercase tracking-widest">&copy; 2026 –ï–ª–µ–Ω–∞. –°–¥–µ–ª–∞–Ω–æ —Å –¥—É—à–æ–π.</p>
    </footer>

    <!-- SUCCESS MODAL -->
    <div id="success-modal" class="fixed inset-0 z-[120] hidden bg-black/95 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="glass-panel w-full max-w-sm p-8 relative border-gold-500/50 text-center transform scale-95 transition-transform duration-300 shadow-[0_0_50px_rgba(212,175,55,0.2)]">
            <button onclick="document.getElementById('success-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-500 hover:text-white transition">
                <i class="fas fa-times text-xl"></i>
            </button>
            <div class="magical-scene">
                <div class="butterfly-container">
                    <div class="butterfly">
                        <div class="wing left"></div>
                        <div class="butterfly-body"></div>
                        <div class="wing right"></div>
                    </div>
                </div>
            </div>
            <h3 class="font-heading text-2xl text-gold-300 mb-2">–û—Å—Ç–∞–ª—Å—è —à–∞–≥!</h3>
            <p class="text-gray-300 text-sm mb-8 leading-relaxed">
                –ß—Ç–æ–±—ã —è –ø–æ–ª—É—á–∏–ª–∞ –≤–∞—à—É –∑–∞—è–≤–∫—É, <span class="text-white font-bold">–æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ—ë –±–æ—Ç—É</span>.
            </p>
            <button id="success-telegram-btn" class="w-full btn-gold py-4 rounded-lg text-sm font-bold uppercase cursor-pointer shadow-[0_0_20px_rgba(212,175,55,0.4)] animate-pulse-gold">
                <i class="fab fa-telegram-plane mr-2 text-lg"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤ Telegram
            </button>
            <p class="text-[10px] text-gray-600 mt-4 uppercase tracking-tighter">–ó–∞–ø–∏—Å—å –±—É–¥–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –ø–æ—Å–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è</p>
        </div>
    </div>

    <!-- REVIEW FORM MODAL -->
    <div id="review-modal" class="fixed inset-0 z-[100] hidden bg-black/80 flex items-center justify-center p-4">
        <div class="glass-panel w-full max-w-md p-8 relative border-gold-500/50">
            <button onclick="closeReviewModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white cursor-pointer"><i class="fas fa-times text-xl"></i></button>
            <h3 class="font-heading text-2xl text-gold-300 mb-6 text-center">–í–∞—à –û—Ç–∑—ã–≤</h3>
            <form id="review-form" class="space-y-4" onsubmit="submitReview(event)">
                <input type="text" id="review-name" placeholder="–í–∞—à–µ –ò–º—è" required class="input-gold">
                <textarea id="review-text" rows="4" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –ø–∞—Ä—É —Ç–µ–ø–ª—ã—Ö —Å–ª–æ–≤..." required class="input-gold"></textarea>
                <div class="flex justify-center gap-2 text-2xl mb-4" id="star-rating">
                    <i class="fas fa-star text-gray-600 cursor-pointer hover:text-gold-500 transition" onclick="setRating(1)"></i>
                    <i class="fas fa-star text-gray-600 cursor-pointer hover:text-gold-500 transition" onclick="setRating(2)"></i>
                    <i class="fas fa-star text-gray-600 cursor-pointer hover:text-gold-500 transition" onclick="setRating(3)"></i>
                    <i class="fas fa-star text-gray-600 cursor-pointer hover:text-gold-500 transition" onclick="setRating(4)"></i>
                    <i class="fas fa-star text-gray-600 cursor-pointer hover:text-gold-500 transition" onclick="setRating(5)"></i>
                </div>
                <button type="submit" class="w-full btn-gold py-3 rounded-lg text-sm font-bold uppercase cursor-pointer">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <div id="image-modal" class="fixed inset-0 z-[110] hidden bg-black/95 flex items-center justify-center p-4 cursor-pointer" onclick="closeImageModal()">
        <img id="modal-image" src="" alt="Full Review" class="max-h-[85vh] max-w-full rounded-lg border border-gold-500/30">
    </div>

    <!-- LOGIC -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, doc, deleteDoc, getDocs } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

        let app, auth, db;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        // SAFE FIREBASE INIT
        try {
            if (typeof __firebase_config !== 'undefined') {
                const firebaseConfig = JSON.parse(__firebase_config);
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
            } else {
                console.warn("Firebase config not found. Running in UI-only mode.");
            }
        } catch (e) {
            console.error("Firebase init failed:", e);
        }

        let currentUser = null;
        let currentRating = 5;

        async function initAuth() {
            if (!auth) return;
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                     await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
                onAuthStateChanged(auth, (user) => {
                    currentUser = user;
                    if (user) loadReviews();
                });
            } catch (e) { console.error("Auth error:", e); }
        }

        // --- ROBUST SLOT GENERATION ---
        window.generateTimeSlots = async function(dateString) {
            const container = document.getElementById('time-slots-container');
            const hiddenInput = document.getElementById('selected-time');
            const loader = document.getElementById('slots-loader');
            
            // Reset UI
            container.innerHTML = '';
            hiddenInput.value = '';
            
            if(!dateString) {
                container.innerHTML = '<div class="col-span-3 text-center text-gray-600 text-sm py-2">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</div>';
                return;
            }

            loader.classList.remove('hidden');

            // Try fetching bookings, ignore errors (Offline Mode)
            let bookedTimes = [];
            if (db) {
                try {
                    const querySnapshot = await getDocs(collection(db, 'artifacts', appId, 'public', 'data', 'bookings'));
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        if (data.date === dateString) bookedTimes.push(data.time);
                    });
                } catch (error) { 
                    console.error("DB Error (ignoring for UI):", error); 
                }
            }

            loader.classList.add('hidden');

            // Date parsing that works everywhere
            const dateParts = dateString.split('-'); 
            const year = parseInt(dateParts[0]);
            const month = parseInt(dateParts[1]) - 1; 
            const day = parseInt(dateParts[2]);
            
            const selectedDate = new Date(year, month, day); 
            
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate()); 
            const currentHour = now.getHours();

            const isToday = selectedDate.getTime() === today.getTime();
            const isPastDate = selectedDate < today;

            for(let h = 11; h <= 19; h++) {
                const timeLabel = `${h}:00`;
                
                const isPastHour = isToday && h <= currentHour;
                const isBooked = bookedTimes.includes(timeLabel);
                const isDisabled = isPastDate || isPastHour || isBooked;

                const btn = document.createElement('div');
                btn.className = `time-slot ${isDisabled ? 'disabled' : ''}`;
                btn.textContent = timeLabel;
                
                if (!isDisabled) {
                    btn.onclick = function() {
                        Array.from(container.children).forEach(c => c.classList.remove('selected'));
                        btn.classList.add('selected');
                        hiddenInput.value = timeLabel;
                        document.getElementById('time-error').classList.add('hidden');
                    };
                }
                container.appendChild(btn);
            }
        }

        window.submitBooking = async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('book-name').value;
            const contact = document.getElementById('book-contact').value;
            const date = document.getElementById('book-date').value;
            const time = document.getElementById('selected-time').value;
            const notes = document.getElementById('book-notes').value;
            const btn = e.target.querySelector('button');

            if(!time) {
                document.getElementById('time-error').classList.remove('hidden');
                return;
            }

            btn.innerText = "–û—Ñ–æ—Ä–º–ª—è–µ–º...";
            btn.disabled = true;

            try {
                // Try saving to DB if available
                if (db && currentUser) {
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'bookings'), {
                        name, contact, service: 'Donation', date, time, notes, userId: currentUser.uid, createdAt: serverTimestamp()
                    });
                } else {
                    console.warn("DB unavailable, proceeding to Telegram only.");
                }

                const message = `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ï–ª–µ–Ω–∞! –•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å–∫–ª–∞–¥ (Donation).%0A%0A–ò–º—è: ${name}%0A–î–∞—Ç–∞: ${date}%0A–í—Ä–µ–º—è: ${time}%0A–ó–∞–ø—Ä–æ—Å: ${notes}`;
                const telegramLink = `https://t.me/elena_tarot_soul_bot?text=${message}`;
                
                const modal = document.getElementById('success-modal');
                const tgBtn = document.getElementById('success-telegram-btn');
                
                tgBtn.onclick = () => window.open(telegramLink, '_blank');
                modal.classList.remove('hidden');
                modal.querySelector('.glass-panel').classList.add('scale-100');
                modal.querySelector('.glass-panel').classList.remove('scale-95');

                document.getElementById('booking-form').reset();
                document.getElementById('time-slots-container').innerHTML = '<div class="col-span-3 text-center text-gray-600 text-sm py-2">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</div>';
            } catch (error) { console.error(error); } 
            finally { btn.innerText = "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É"; btn.disabled = false; }
        };

        function loadReviews() {
            if (!db) return;
            const reviewsRef = collection(db, 'artifacts', appId, 'public', 'data', 'reviews');
            onSnapshot(reviewsRef, (snapshot) => {
                const reviewsList = document.getElementById('reviews-list');
                const reviews = [];
                snapshot.forEach(doc => reviews.push({ id: doc.id, ...doc.data() }));
                reviews.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));

                if (reviews.length === 0) {
                    reviewsList.innerHTML = `<div class="col-span-1 md:col-span-2 text-center py-8 glass-panel"><p class="text-gray-400 italic">–°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç –æ—Ç–∑—ã–≤!</p></div>`;
                    return;
                }

                reviewsList.innerHTML = reviews.map(review => {
                    const isOwner = currentUser && review.userId === currentUser.uid;
                    return `
                    <div class="glass-panel p-6 animate-float relative group/review" style="animation-duration: ${Math.random() * 5 + 5}s">
                        ${isOwner ? `<button onclick="deleteReview('${review.id}')" class="absolute top-4 right-4 text-gray-500 hover:text-red-500 transition cursor-pointer z-10 opacity-0 group-hover/review:opacity-100"><i class="fas fa-trash"></i></button>` : ''}
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-gold-900/50 flex items-center justify-center border border-gold-500/30">
                                    <span class="font-heading text-gold-500">${review.name.charAt(0)}</span>
                                </div>
                                <div>
                                    <h4 class="font-bold text-white text-sm">${review.name}</h4>
                                    <div class="flex text-xs text-gold-300">${Array(review.rating || 5).fill('<i class="fas fa-star"></i>').join('')}</div>
                                </div>
                            </div>
                        </div>
                        <p class="text-blue-100 font-light italic leading-relaxed text-sm">"${review.text}"</p>
                    </div>
                `}).join('');
            });
        }

        window.submitReview = async function(e) {
            e.preventDefault();
            if (!currentUser || !db) return;
            const name = document.getElementById('review-name').value;
            const text = document.getElementById('review-text').value;
            const btn = e.target.querySelector('button');
            btn.innerText = "–û—Ç–ø—Ä–∞–≤–∫–∞...";
            btn.disabled = true;
            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'reviews'), {
                    name, text, rating: currentRating, userId: currentUser.uid, createdAt: serverTimestamp()
                });
                closeReviewModal();
                document.getElementById('review-form').reset();
            } catch (error) { console.error(error); }
            finally { btn.innerText = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"; btn.disabled = false; }
        };

        window.deleteReview = async function(docId) {
            if(!confirm("–£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤?") || !db) return;
            try { await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'reviews', docId)); } catch (e) { console.error(e); }
        }

        initAuth();
        
        window.addEventListener('load', () => {
             const today = new Date().toISOString().split('T')[0];
             const dateInput = document.getElementById('book-date');
             if(dateInput) dateInput.setAttribute('min', today);
        });

        window.setRating = function(rating) {
            currentRating = rating;
            const stars = document.getElementById('star-rating').children;
            for (let i = 0; i < stars.length; i++) {
                stars[i].classList.toggle('text-gold-300', i < rating);
                stars[i].classList.toggle('text-gray-600', i >= rating);
            }
        }
        window.setRating(5);
    </script>

    <!-- VISUAL SCRIPTS -->
    <script>
        window.addEventListener('load', () => {
            setTimeout(() => {
                const pre = document.getElementById('preloader');
                if (pre) {
                    pre.style.opacity = '0';
                    setTimeout(() => { pre.remove(); }, 800);
                }
            }, 1000);
        });

        window.scrollGallery = function(direction) {
            const container = document.getElementById('gallery-container');
            container.scrollBy({ left: direction * 320, behavior: 'smooth' });
        }

        function openReviewModal() { document.getElementById('review-modal').classList.remove('hidden'); }
        function closeReviewModal() { document.getElementById('review-modal').classList.add('hidden'); }
        function openImageModal(el) {
            document.getElementById('modal-image').src = el.querySelector('img').src;
            document.getElementById('image-modal').classList.remove('hidden');
        }
        function closeImageModal() { document.getElementById('image-modal').classList.add('hidden'); }

        const chaosCanvas = document.getElementById('chaos-bg');
        const chaosCtx = chaosCanvas.getContext('2d');
        let cw, ch, blobs = [];

        class EnergyBlob {
            constructor(type) { this.init(type); }
            init(type) {
                this.type = type;
                this.radius = Math.random() * 200 + 150;
                this.x = Math.random() * cw; this.y = Math.random() * ch;
                this.vx = (Math.random()-0.5)*0.8; this.vy = (Math.random()-0.5)*0.8;
                this.growth = (Math.random()-0.5)*0.3;
                if(type === 'white') { this.color1 = 'rgba(255, 255, 255, 0.3)'; this.color2 = 'rgba(200, 200, 255, 0.1)'; } 
                else if (type === 'gold') { this.color1 = 'rgba(255, 215, 0, 0.3)'; this.color2 = 'rgba(218, 165, 32, 0.1)'; } 
                else { this.color1 = 'rgba(0, 0, 0, 0.9)'; this.color2 = 'rgba(20, 10, 30, 0.5)'; }
            }
            update() {
                this.x += this.vx; this.y += this.vy; this.radius += this.growth;
                if(this.x < -this.radius) this.x = cw+this.radius; if(this.x > cw+this.radius) this.x = -this.radius;
                if(this.y < -this.radius) this.y = ch+this.radius; if(this.y > ch+this.radius) this.y = -this.radius;
                if(this.radius > 700 || this.radius < 100) this.growth *= -1;
            }
            draw() {
                const g = chaosCtx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.radius);
                if(this.type === 'white' || this.type === 'gold') { g.addColorStop(0, this.color1); g.addColorStop(1, 'transparent'); chaosCtx.globalCompositeOperation = 'screen'; } 
                else { g.addColorStop(0, this.color1); g.addColorStop(0.8, this.color2); g.addColorStop(1, 'transparent'); chaosCtx.globalCompositeOperation = 'source-over'; }
                chaosCtx.fillStyle = g; chaosCtx.beginPath(); chaosCtx.arc(this.x, this.y, this.radius, 0, Math.PI*2); chaosCtx.fill();
            }
        }

        function initChaos() {
            cw = chaosCanvas.width = window.innerWidth; ch = chaosCanvas.height = window.innerHeight;
            blobs = [];
            for(let i=0; i<6; i++) blobs.push(new EnergyBlob('white'));
            for(let i=0; i<6; i++) blobs.push(new EnergyBlob('gold'));
            for(let i=0; i<5; i++) blobs.push(new EnergyBlob('dark'));
        }
        function animateChaos() {
            chaosCtx.clearRect(0,0,cw,ch);
            chaosCtx.fillStyle = '#000'; chaosCtx.fillRect(0,0,cw,ch);
            blobs.forEach(b => { b.update(); b.draw(); });
            requestAnimationFrame(animateChaos);
        }
        window.addEventListener('resize', initChaos); initChaos(); animateChaos();

        const dCanvas = document.getElementById('magic-dust');
        const dCtx = dCanvas.getContext('2d');
        let dw, dh, particles = [], mouse = {x: -100, y: -100};
        const cursor = document.getElementById('custom-cursor');

        document.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX; mouse.y = e.clientY;
            if(cursor) { cursor.style.left = mouse.x+'px'; cursor.style.top = mouse.y+'px'; }
            for(let i=0; i<2; i++) particles.push(new Particle(mouse.x, mouse.y, true));
        });

        function resizeDust() { dw = dCanvas.width = window.innerWidth; dh = dCanvas.height = window.innerHeight; }
        window.addEventListener('resize', resizeDust); resizeDust();

        class Particle {
            constructor(x, y, fromMouse) {
                this.x = x || Math.random()*dw; this.y = y || dh+10;
                this.speedX = fromMouse ? (Math.random()*3-1.5) : (Math.random()*1-0.5);
                this.speedY = fromMouse ? (Math.random()*3-1.5) : (Math.random()*-1-0.5);
                this.size = Math.random()*3+0.5;
                this.life = fromMouse ? 100 : Math.random()*200+100; this.maxLife = this.life;
                this.color = Math.random()>0.3 ? '#D4AF37' : '#FFFFFF';
            }
            update() { this.x+=this.speedX; this.y+=this.speedY; this.life--; }
            draw() {
                dCtx.fillStyle = this.color; dCtx.globalAlpha = (this.life/this.maxLife)*0.8;
                dCtx.beginPath(); dCtx.arc(this.x, this.y, Math.abs(this.size), 0, Math.PI*2); dCtx.fill();
            }
        }
        function animateDust() {
            dCtx.clearRect(0,0,dw,dh);
            if(particles.length < 100) particles.push(new Particle(null, null, false));
            particles.forEach((p, i) => { p.update(); p.draw(); if(p.life<=0 || p.y<-10) particles.splice(i, 1); });
            requestAnimationFrame(animateDust);
        }
        animateDust();

        const tarotData = [
            { name: "–¢—É–∑ –ü–µ–Ω—Ç–∞–∫–ª–µ–π", desc: "–î–≤–µ—Ä—å –∫ –±–æ–≥–∞—Ç—Å—Ç–≤—É –æ—Ç–∫—Ä—ã—Ç–∞. –í—Å–µ–ª–µ–Ω–Ω–∞—è –¥–∞—Ä–∏—Ç —Ç–µ–±–µ —Ä–µ—Å—É—Ä—Å.", icon: "fas fa-coins" },
            { name: "–í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞", desc: "–¢–∞–π–Ω—ã–µ –∑–Ω–∞–Ω–∏—è. –û—Ç–≤–µ—Ç –ø—Ä–∏–¥–µ—Ç –≤–æ —Å–Ω–µ –∏–ª–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ç—É–∏—Ü–∏—é.", icon: "fas fa-scroll" },
            { name: "–°–æ–ª–Ω—Ü–µ", desc: "–ê–±—Å–æ–ª—é—Ç–Ω—ã–π —É—Å–ø–µ—Ö. –¢–µ–Ω–∏ –æ—Ç—Å—Ç—É–ø–∞—é—Ç, –≤–ø–µ—Ä–µ–¥–∏ —Ç–æ–ª—å–∫–æ —Å–≤–µ—Ç.", icon: "fas fa-sun" },
            { name: "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞", desc: "–†–æ–∂–¥–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ. –ò–∑–æ–±–∏–ª–∏–µ –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ.", icon: "fas fa-seedling" },
            { name: "–ó–≤–µ–∑–¥–∞", desc: "–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–≤–µ—Ç–Ω–æ–π –º–µ—á—Ç—ã. –ù–µ —Ç–µ—Ä—è–π –Ω–∞–¥–µ–∂–¥—ã.", icon: "fas fa-star" },
            { name: "–í–ª—é–±–ª–µ–Ω–Ω—ã–µ", desc: "–ì–∞—Ä–º–æ–Ω–∏—è –∏ –≤—ã–±–æ—Ä —Å–µ—Ä–¥—Ü–µ–º.", icon: "fas fa-heart" }
        ];
        const deckEl = document.getElementById('tarot-deck');
        let hasChosen = false;
        function initDeck() {
            deckEl.innerHTML = ''; hasChosen = false;
            for(let i=0; i<3; i++) {
                const w = document.createElement('div');
                w.className = 'tarot-card-wrapper h-full w-full cursor-pointer group';
                w.innerHTML = `<div class="tarot-card-inner group-hover:-translate-y-4 transition duration-500"><div class="card-face card-front"><div class="eye-symbol"></div></div><div class="card-face card-back"><i class="fas fa-spinner fa-spin text-gold-500 text-2xl"></i></div></div>`;
                w.onclick = () => revealCard(w);
                deckEl.appendChild(w);
            }
        }
        function revealCard(el) {
            if(hasChosen) return; hasChosen = true;
            const card = tarotData[Math.floor(Math.random()*tarotData.length)];
            el.querySelector('.card-back').innerHTML = `<i class="${card.icon} text-5xl text-gold-500 mb-4"></i><div class="font-heading text-lg text-gold-100 text-center px-2">${card.name}</div>`;
            el.classList.add('flipped');
            Array.from(deckEl.children).forEach(c => { if(c!==el) c.style.opacity='0.2'; });
            setTimeout(() => {
                const res = document.getElementById('tarot-result');
                document.getElementById('result-icon').className = card.icon;
                document.getElementById('result-title').innerText = card.name;
                document.getElementById('result-desc').innerText = card.desc;
                res.classList.remove('hidden');
            }, 600);
        }
        window.resetTarot = function() { document.getElementById('tarot-result').classList.add('hidden'); initDeck(); }
        initDeck();

        window.activatePortal = function() {
            const t = document.getElementById('portal-text'), c = document.querySelector('.portal-core');
            const answers = ["–î–ê", "–ù–ï–¢", "–í–µ—Ä—å", "–ñ–¥–∏", "–î–µ–π—Å—Ç–≤—É–π"];
            t.style.opacity = '0'; c.style.transform = 'scale(0.8)';
            setTimeout(() => {
                c.style.transform = 'scale(1.1)';
                t.innerText = answers[Math.floor(Math.random()*answers.length)];
                t.style.opacity = '1';
            }, 400);
        }
        const msgs = ["–°–≤–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Ç–µ–±—è —Å–∏–ª—å–Ω–µ–µ —Ç—å–º—ã.", "–¢–≤–æ–π –∑–∞–ø—Ä–æ—Å —É—Å–ª—ã—à–∞–Ω.", "–û—Ç–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å.", "–ú–∞–≥–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –≤–µ—Ä—ã."];
        window.getNewMessage = function() {
            const el = document.getElementById('daily-msg');
            el.style.opacity = '0';
            setTimeout(() => { el.innerText = `"${msgs[Math.floor(Math.random()*msgs.length)]}"`; el.style.opacity = '1'; }, 500);
        }
    </script>
</body>
</html>